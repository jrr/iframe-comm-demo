<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <script>
    function sendMessageToIframe() {
      console.log("Outside: sendMessageToIframe()");
      i = document.querySelector("iframe");
      i.contentWindow.postMessage("hello from parent", "*");
    }
    window.addEventListener(
      "message",
      (event) => {
        console.log("Outside: received message:", event);
        document.getElementById("message-buffer").append(event.data + "\n");
      },
      false
    );
  </script>

  <body>
    <h1>iframe communication</h1>
    <p>
      This is a demo of communication across an iframe. For demonstration
      purposes it's hosted at two different places:
    </p>
    <ul>
      <li>https://jrr.github.io/iframe-comm-demo/</li>
      <li>https://john-ruble.gitlab.io/iframe-comm-demo/</li>
    </ul>
    <center>
      <table width="100%" height="50%" border="1">
        <thead>
          <th>Outside</th>
          <th>Iframe</th>
        </thead>
        <tr>
          <td width="50%">
            <p id="page-id"></p>
            <button onclick="sendMessageToIframe()">
              Send Message To Iframe
            </button>
            <hr />
            <pre id="message-buffer" />
          </td>
          <td width="50%">
            <iframe src="iframe.html" width="100%" height="100%"></iframe>
          </td>
        </tr>
      </table>
    </center>

    <script>
      document.getElementById("page-id").innerText = `(${document.URL})`;
    </script>
  </body>
</html>
